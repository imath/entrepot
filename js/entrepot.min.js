/*! entrepot - v1.0.0-beta1 - 2017-06-20 8:40:08 PM UTC - https://imathi.eu/tag/entrepot */
window.wp=window.wp||{},window.entrepot=window.entrepot||_.extend({},_.pick(window.wp,"Backbone","template")),function(a){return"undefined"!=typeof entrepotl10n&&(a(document).ready(function(){a("body").addClass("entrepot-install-php");var b=a(".plugin-install-php .wp-filter-search");a(b).removeClass("wp-filter-search").prop("id","entrepot-search").css({margin:0,width:"280px","font-size":"16px","font-weight":300,"line-height":1.5,padding:"3px 5px",height:"32px"}),a('#typeselector [value="tag"]').remove(),a("#the-list").css({"margin-top":"2em"})}),entrepot.Views=entrepot.Views||{},entrepot.View=entrepot.Backbone.View.extend({prepare:function(){return!_.isUndefined(this.model)&&_.isFunction(this.model.toJSON)?this.model.toJSON():{}}}),entrepot.Views.Card=entrepot.View.extend({className:"plugin-card",template:entrepot.template("entrepot-repository"),initialize:function(){var a,b=this.model.get("description"),c="",d=entrepotl10n.defaultIcon;c=_.isUndefined(b[entrepotl10n.locale])?b.en_US:b[entrepotl10n.locale],a=this.model.get("author"),this.model.get("author_url")&&(a='<a href="'+this.model.get("author_url")+'">'+a+"</a>"),a=entrepotl10n.byAuthor.replace("%s",a),this.model.get("icon")&&(d=this.model.get("icon")),this.model.set({presentation:c,icon:d,author:a},{silent:!0}),this.model.get("name")&&(this.el.className+=" plugin-card-"+this.model.get("slug")),this.$el.prop("id",this.model.get("id"))}}),entrepot.Views.List=entrepot.View.extend({initialize:function(){_.each(this.collection.models,function(a){this.displayRepository(a)},this),a("#entrepot-search").on("keyup input",_.bind(this.searchRepositories,this)),a("#typeselector").on("change",this.resetSearch)},displayRepository:function(a){this.views.add(new entrepot.Views.Card({model:a}))},searchRepositories:function(b){var c=a("#typeselector").val(),d=a(b.currentTarget).val().toLowerCase();b.preventDefault(),d?_.each(this.collection.models,function(b){var e=a("#"+b.get("id"));"term"===c&&-1===b.get("name").toLowerCase().indexOf(d)&&-1===b.get("presentation").toLowerCase().indexOf(d)||"author"===c&&-1===b.get("author").toLowerCase().indexOf(d)?e.addClass("hide-if-js"):e.removeClass("hide-if-js")}):a("#the-list .plugin-card").removeClass("hide-if-js")},resetSearch:function(b){b.preventDefault(),a("#entrepot-search").val(""),a("#the-list .plugin-card").removeClass("hide-if-js")}}),entrepot.App={init:function(b){this.views=new Backbone.Collection,this.repositories=new Backbone.Collection(b),this.list=new entrepot.Views.List({el:a("#the-list"),collection:this.repositories}).render()}},void a.getJSON(entrepotl10n.url,function(a){return!!a&&(a.sort(function(){return.5-Math.random()}),void entrepot.App.init(a))}).fail(function(b){a("#the-list").append('<div id="message" class="error"><p>'+a.parseJSON(b.responseText)+"</p></div>")}))}(jQuery);